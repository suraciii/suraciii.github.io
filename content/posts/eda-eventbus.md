---
title: "在事件驱动架构中需要怎样的事件基础设施"
date: 2023-06-30T00:00:00Z
draft: true
---

这是一个简单的事件驱动系统的工作流：

这样的系统中，其相当一部分的业务流程是以相关事件的发布/订阅进行流转的，而在一些更为激进的事件驱动架构实现中，可能其内部绝大多数的交互都是是以事件而非命令（如HTTP/RPC等）的方式进行。

设计良好的事件驱动架构的确有着一些优势，比如：
* 耦合度低，更为灵活，向系统添加新模块较为方便
* 具备较高的响应性，避免了上游的阻塞和等待
* 具备高度的可扩展性和分布式
* 以及一个不容易被注意到却又十分重要的优势：为业务流程提供了高度的弹性，或者说可恢复性，在分布式环境中，大量的命令式（HTTP/RPC）交互会严重降低系统总体的可靠性，如何弥补这些损失的可靠性是一个非常令人头疼的问题，而事件驱动架构就是解决这个问题的极佳方案

想要设计以及实现好这样的一个事件驱动架构的系统，就不得不考虑一个至关重要的问题：这个系统需要怎样的事件基础设施，这里简单将其称为事件总线

## 事件总线不是什么？

想要知道一个东西是什么的最好方法，就是首先搞清楚它不是什么

### 事件总线和消息队列

许多人很容易进入的一个误区就是混淆事件总线和消息队列，的确，事件总线通常是以消息队列产品（如Kafka、Pulsar等）实现

但是事件总线和消息队列有着一些不同：

首先，队列是队列，是队列，就有进有出，先进先出的，队列中的消息一旦出队被处理，它的任务就结束了，也就是说，消息是*严格有序*的，是*非持久*的，消息队列只会有一方消费者

而事件总线不同的是，事件流中的事件会被持久化，以供可能的多方消费者消费，此外，事件消费者通常不会在意事件的交付顺序——在事件驱动架构中，业务的正确性通常是由事件产生的因果而非事件流中的事件顺序保证的

### 事件总线和事件溯源




